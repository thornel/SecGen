<?xml version="1.0"?>

<scenario xmlns="http://www.github/cliffe/SecGen/scenario"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.github/cliffe/SecGen/scenario">

	<name>Understanding Software Vulnerabilities: C, Debugging Assembly, and Buffer Overflows</name>
  <author>Z. Cliffe Schreuders</author>
  <description>

		A MetaCTF lab. In your home directory you will find some binaries that you need to reverse engineer in order to determine the password that the program expects. Once you determing the password, run the program and enter the password to receive the file.

	[Lab sheet here](https://docs.google.com/document/d/1AxTve1RBzqvdPxt8Wziga2x2e3lZp4k5YsMq3KxkXzM/edit?usp=sharing).
	</description>

  <type>ctf-lab</type>
  <type>lab-sheet</type>
  <difficulty>intermediate</difficulty>

  <CyBOK KA="SS" topic="Categories of Vulnerabilities">
		<keyword>Integer overflow</keyword>
	</CyBOK>
  <CyBOK KA="SS" topic="Prevention of Vulnerabilities">
		<keyword>language design and type systems</keyword>
	</CyBOK>

	<video>
		<title>Software, Vulnerabilities and Exploits</title>
		<by>Tom Shaw</by>
		<url>https://youtu.be/jo_07iOplzA</url>
		<type>lecture-prerecorded</type>
		<CyBOK KA="MAT" topic="Attacks and exploitation">
			<keyword>EXPLOITATION</keyword>
		</CyBOK>
	</video>
	<video>
		<title>Software Vulnerabilities</title>
		<by>Tom Shaw</by>
		<url>https://youtu.be/1Hy_166CwRk</url>
		<type>lecture-prerecorded</type>
		<CyBOK KA="MAT" topic="Attacks and exploitation">
			<keyword>EXPLOITATION</keyword>
		</CyBOK>
	</video>




  <system>
    <system_name>desktop</system_name>
    <base platform="linux" type="desktop" distro="Buster"/>

    <utility module_path=".*/reversing_tools"/>

    <utility module_path=".*/parameterised_accounts">
      <input into="accounts" into_datastore="account">
        <generator type="account">
					<input into="username">
						<generator type="random_sanitised_word">
							<input into="wordlist">
								<value>mythical_creatures</value>
							</input>
						</generator>
					</input>
					<input into="password">
						<value>tiaspbiqe2r</value>
					</input>
					<input into="super_user">
						<value>false</value>
					</input>
        </generator>
      </input>
    </utility>


		<utility module_path=".*/kde_minimal">
			<input into="autologin_user">
				<datastore access="0" access_json="['username']">account</datastore>
			</input>
			<input into="accounts">
				<datastore>account</datastore>
			</input>
			<input into="autostart_konsole">
				<value>true</value>
			</input>
		</utility>
		<utility module_path=".*/handy_cli_tools"/>
		<utility module_path=".*/hash_tools"/>

    <utility module_path=".*/metactf">
      <input into="challenge_list">
				<generator type="metactf_challenge">
          <input into="challenge_path">
						<value>src_csp/Ch1-2/Ch2_03_IntOverflow</value>
          </input>
        </generator>
      </input>
      <input into="account">
        <datastore>account</datastore>
      </input>
    </utility>

    <network type="private_network" range="dhcp"/>
  </system>

</scenario>
