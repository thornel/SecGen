<?xml version="1.0"?>

<scenario xmlns="http://www.github/cliffe/SecGen/scenario"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:schemaLocation="http://www.github/cliffe/SecGen/scenario">

	<name>Introdution to Malware analysis lab</name>
  <author>Z. Cliffe Schreuders</author>
  <description>A MetaCTF lab. In your home directory you will find some binaries that you need to reverse engineer in order to determine the password that the program expects. Once you determing the password, run the program and enter the password to receive the file.

	[Lab sheet here](https://docs.google.com/document/d/1CRGtnCTOogpEIjl-tLYdZqHBwJt75FpUJTE2xUL9wqI/edit?usp=sharing).
	</description>

  <type>ctf-lab</type>
  <type>lab-sheet</type>
  <difficulty>intermediate</difficulty>

	<CyBOK KA="MAT" topic="Malware Taxonomy">
		<keyword>dimensions</keyword>
		<keyword>kinds</keyword>
	</CyBOK>
	<CyBOK KA="MAT" topic="Malware Analysis">
		<keyword>analysis techniques</keyword>
		<keyword>analysis environments</keyword>
	</CyBOK>

	<video>
		<title>Reverse Engineering and Malware Analysis: Part 1 Static Analysis</title>
		<by>Z. Cliffe Schreuders</by>
		<url>https://youtu.be/14Hv_QodLxs</url>
		<type>lecture-prerecorded</type>
		<CyBOK KA="MAT" topic="Malware Analysis">
			<keyword>analysis techniques</keyword>
			<keyword>analysis environments</keyword>
			<keyword>STATIC ANALYSIS</keyword>
		</CyBOK>
	</video>
	<video>
		<title>Reverse Engineering and Malware Analysis: Part 2 Dynamic Analysis</title>
		<by>Z. Cliffe Schreuders</by>
		<url>https://youtu.be/quKsZbpvYIY</url>
		<type>lecture-prerecorded</type>
		<CyBOK KA="MAT" topic="Malware Analysis">
			<keyword>analysis techniques</keyword>
			<keyword>analysis environments</keyword>
			<keyword>DYNAMIC ANALYSIS</keyword>
		</CyBOK>
	</video>
	<video>
		<title>The Problem of Malware</title>
		<by>Z. Cliffe Schreuders</by>
		<url>https://youtu.be/CxZx7b3OPsg</url>
		<type>lecture-prerecorded</type>
		<CyBOK KA="MAT" topic="Malware Taxonomy">
			<keyword>potentially unwanted programs</keyword>
		</CyBOK>
		<CyBOK KA="OSV" topic="Attacker Model">
			<keyword>attack surface</keyword>
			<keyword>threats to security for modern OSs</keyword>
		</CyBOK>
	</video>
	<video>
		<title>Malware Types</title>
		<by>Z. Cliffe Schreuders</by>
		<url>https://youtu.be/3qmmqfBtJio</url>
		<type>lecture-prerecorded</type>
		<CyBOK KA="MAT" topic="Malware Taxonomy">
			<keyword>dimensions</keyword>
			<keyword>kinds</keyword>
			<keyword>potentially unwanted programs</keyword>
		</CyBOK>
	</video>
	<video>
		<title>Stopping Malware</title>
		<by>Z. Cliffe Schreuders</by>
		<url>https://youtu.be/k3NwrFWuhaY</url>
		<type>lecture-prerecorded</type>
		<CyBOK KA="MAT" topic="Malware Detection">
			<keyword>ANTI-MALWARE - SYSTEMS</keyword>
			<keyword>ANTIVIRUS SOFTWARE</keyword>
			<keyword>MALCODE/MALWARE - COUNTERMEASURES - CODE SIGNING</keyword>
			<keyword>MALCODE/MALWARE - COUNTERMEASURES - SANDBOXING</keyword>
			<keyword>MALCODE/MALWARE - THIRD-PARTY CERTIFICATIONS</keyword>
		</CyBOK>
	</video>

  <system>
    <system_name>metactf</system_name>
    <base platform="linux" type="desktop" distro="Buster"/>

    <utility module_path=".*/reversing_tools"/>

    <utility module_path=".*/parameterised_accounts">
      <input into="accounts" into_datastore="account">
        <generator type="account">
					<input into="username">
						<generator type="random_sanitised_word">
							<input into="wordlist">
								<value>mythical_creatures</value>
							</input>
						</generator>
					</input>
					<input into="password">
						<value>tiaspbiqe2r</value>
					</input>
					<input into="super_user">
						<value>false</value>
					</input>
        </generator>
      </input>
    </utility>


		<utility module_path=".*/kde_minimal">
			<input into="autologin_user">
				<datastore access="0" access_json="['username']">account</datastore>
			</input>
			<input into="accounts">
				<datastore>account</datastore>
			</input>
			<input into="autostart_konsole">
				<value>true</value>
			</input>
		</utility>
		<utility module_path=".*/handy_cli_tools"/>
		<utility module_path=".*/hash_tools"/>

    <utility module_path=".*/metactf">
      <input into="challenge_list">
				<generator type="metactf_challenge">
          <input into="challenge_path">
            <value>src_csp/Ch1-2/Ch1_Ltrace</value>
          </input>
        </generator>
        <generator type="metactf_challenge">
          <input into="challenge_path">
            <value>src_csp/Ch1-2/Ch1_Readelf</value>
          </input>
        </generator>

      </input>
      <input into="account">
        <datastore>account</datastore>
      </input>
    </utility>

    <network type="private_network" range="dhcp"/>
  </system>

</scenario>
