<?xml version="1.0"?>

<scenario xmlns="http://www.github/cliffe/SecGen/scenario"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="http://www.github/cliffe/SecGen/scenario">

	<name>pcap_file Example</name>
	<author>Jason Zeller</author>

	<description>
		This scenario demonstrates leaking a pcap file with a flag embedded and cleartext.
	</description>

	<type>ctf</type>
	<difficulty>easy</difficulty>

	<system>
		<system_name>server</system_name>
		<base platform="linux" type="server"/>

    <!-- Release pcap file -->
		<vulnerability type="pcap">
			<input into="base64_file">
				<generator type="pcap_generator">
					<input into="strings_to_leak">
						<generator type="flag_generator"/>
						<value>
							******SECRET*******From now on, make sure that all network traffic is properly encrypted.******SECRET******
						</value>
					</input>
    		</generator>
			</input>
			<input into="leaked_filename">
				<value>capture.pcap</value>
			</input>
      <input into="storage_directory">
        <value>/var/log</value>
      </input>
		</vulnerability>

  </system>

</scenario>
