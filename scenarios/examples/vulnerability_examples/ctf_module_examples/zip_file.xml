<?xml version="1.0"?>

<scenario xmlns="http://www.github/cliffe/SecGen/scenario"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="http://www.github/cliffe/SecGen/scenario">

	<name>zip_file Example</name>
	<author>Jason Zeller</author>

	<description>
		This scenario demonstrates leaking a zip file with a flag embedded and zip can be password protected.
	</description>

	<type>ctf</type>
	<difficulty>easy</difficulty>

	<system>
		<system_name>server</system_name>
		<base platform="linux" type="server"/>

		<!-- Release zip file -->
		<vulnerability type="zip_file">
			<input into="base64_file">
				<generator type="zip_file_generator">
      		<input into="password">
						<generator type="custom_list_password">
        			<input into="list_name">
          			<value>jtrpassword.lst</value>
        			</input>
      			</generator>
      		</input>
					<input into="strings_to_leak">
						<generator type="flag_generator"/>
						<value>
							Congratulations you have cracked our protected zip file. We wish there was more information here but we are just not that smart. Here is a flag for your troubles.
						</value>
					</input>
    		</generator>
			</input>
			<input into="leaked_filename">
				<value>protected.zip</value>
			</input>
			<input into="storage_directory">
        <value>/var/log</value>
      </input>
		</vulnerability>

  </system>

</scenario>
